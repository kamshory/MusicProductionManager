(function(){function e(t,n,r){function o(i,s){if(!n[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var c=Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){return o(t[i][1][e]||e)},l,l.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}return e})()({1:[function(e,t,n){"use strict";var r=e("audio-loader"),o=e("sample-player");function a(e){return/\.js(\?.*)?$/i.test(e)}function i(e,t,n){return"https://gleitz.github.io/midi-js-soundfonts/"+(t="FluidR3_GM"===t?t:"MusyngKite")+"/"+e+"-"+(n="ogg"===n?n:"mp3")+".js"}var s=e("./legacy");s.instrument=function e(t,n,s){if(1===arguments.length)return function(n,r){return e(t,n,r)};var u=s||{},c=u.isSoundfontURL||a,l=u.nameToUrl||i,f=c(n)?n:l(n,u.soundfont,u.format);return r(t,f,{only:u.only||u.notes}).then(function(e){var r=o(t,e,u).connect(u.destination?u.destination:t.destination);return r.url=f,r.name=n,r})},s.nameToUrl=i,"object"==typeof t&&t.exports&&(t.exports=s),"undefined"!=typeof window&&(window.Soundfont=s)},{"./legacy":2,"audio-loader":6,"sample-player":10},],2:[function(e,t,n){"use strict";var r=e("note-parser");function o(e,t){if(console.warn("new Soundfont() is deprected"),console.log("Please use Soundfont.instrument() instead of new Soundfont().instrument()"),!(this instanceof o))return new o(e);this.nameToUrl=t||o.nameToUrl,this.ctx=e,this.instruments={},this.promises=[]}o.prototype.onready=function(e){console.warn("deprecated API"),console.log("Please use Promise.all(Soundfont.instrument(), Soundfont.instrument()).then() instead of new Soundfont().onready()"),Promise.all(this.promises).then(e)},o.prototype.instrument=function(e,t){console.warn("new Soundfont().instrument() is deprecated."),console.log("Please use Soundfont.instrument() instead.");var n=this.ctx;if((e=e||"default")in this.instruments)return this.instruments[e];var a,i,s={name:e,play:(a=n,i=t,i=i||{},function(e,t,n,o){console.warn("The oscillator player is deprecated."),console.log("Starting with version 0.9.0 you will have to wait until the soundfont is loaded to play sounds.");var s=e>0&&e<129?+e:r.midi(e),u=s?r.midiToFreq(s,440):null;if(u){n=n||.2;var c=(o=o||{}).destination||i.destination||a.destination,l=o.vcoType||i.vcoType||"sine",f=o.gain||i.gain||.4,d=a.createOscillator();d.type=l,d.frequency.value=u;var p=a.createGain();return p.gain.value=f,d.connect(p),p.connect(c),d.start(t),n>0&&d.stop(t+n),d}})};if(this.instruments[e]=s,"default"!==e){var u=o.instrument(n,e,t).then(function(e){return s.play=e.play,s});this.promises.push(u),s.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),u.then(e)}}else s.onready=function(e){console.warn("onready is deprecated. Use Soundfont.instrument().then()"),e()};return s},o.loadBuffers=function e(t,n,r){return console.warn("Soundfont.loadBuffers is deprecate."),console.log("Use Soundfont.instrument(..) and get buffers properties from the result."),o.instrument(t,n,r).then(function(e){return e.buffers})},o.noteToMidi=r.midi,t.exports=o},{"note-parser":8},],3:[function(e,t,n){t.exports=function e(t){var n,i,s,u=t.createGain(),c=u._voltage=(n=t,i=n.createBufferSource(),s=n.createBuffer(1,2,n.sampleRate),s.getChannelData(0).set(o),i.buffer=s,i.loop=!0,i),l=a(c),f=a(c),d=a(c);return u._startAmount=a(f),u._endAmount=a(d),u._multiplier=a(l),u._multiplier.connect(u),u._startAmount.connect(u),u._endAmount.connect(u),u.value=l.gain,u.startValue=f.gain,u.endValue=d.gain,u.startValue.value=0,u.endValue.value=0,Object.defineProperties(u,r),u};var r={attack:{value:0,writable:!0},decay:{value:0,writable:!0},sustain:{value:1,writable:!0},release:{value:0,writable:!0},getReleaseDuration:{value:function(){return this.release}},start:{value:function(e){var t=this._multiplier.gain,n=this._startAmount.gain,r=this._endAmount.gain;this._voltage.start(e),this._decayFrom=this._decayFrom=e+this.attack,this._startedAt=e;var o=this.sustain;t.cancelScheduledValues(e),n.cancelScheduledValues(e),r.cancelScheduledValues(e),r.setValueAtTime(0,e),this.attack?(t.setValueAtTime(0,e),t.linearRampToValueAtTime(1,e+this.attack),n.setValueAtTime(1,e),n.linearRampToValueAtTime(0,e+this.attack)):(t.setValueAtTime(1,e),n.setValueAtTime(0,e)),this.decay&&t.setTargetAtTime(o,this._decayFrom,i(this.decay))}},stop:{value:function(e,t){t&&(e-=this.release);var n=e+this.release;if(this.release){var r=this._multiplier.gain,o=this._startAmount.gain,a=this._endAmount.gain;r.cancelScheduledValues(e),o.cancelScheduledValues(e),a.cancelScheduledValues(e);var s=i(this.release);if(this.attack&&e<this._decayFrom){var u,c,l,f,d=0,p=1,h=(u=this._startedAt,c=this._decayFrom,l=e,f=d+(l-u)/(c-u)*(p-d),f<=d&&(f=d),f>=p&&(f=p),f);r.linearRampToValueAtTime(h,e),o.linearRampToValueAtTime(1-h,e),o.setTargetAtTime(0,e,s)}a.setTargetAtTime(1,e,s),r.setTargetAtTime(0,e,s)}return this._voltage.stop(n),n}},onended:{get:function(){return this._voltage.onended},set:function(e){this._voltage.onended=e}}},o=new Float32Array([1,1]);function a(e){var t=e.context.createGain();return e.connect(t),t}function i(e){return Math.log(e+1)/Math.log(100)}},{},],4:[function(e,t,n){"use strict";function r(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0}t.exports={decode:function e(t,n){for(var o,a,i=t.replace(/[^A-Za-z0-9\+\/]/g,""),s=i.length,u=n?Math.ceil((3*s+1>>2)/n)*n:3*s+1>>2,c=new Uint8Array(u),l=0,f=0,d=0;d<s;d++)if(a=3&d,l|=r(i.charCodeAt(d))<<18-6*a,3===a||s-d==1){for(o=0;o<3&&f<u;o++,f++)c[f]=l>>>(16>>>o&24)&255;l=0}return c}}},{},],5:[function(e,t,n){"use strict";t.exports=function(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;t&&(o.responseType=t),o.open("GET",e),o.onload=function(){200===o.status?n(o.response):r(Error(o.statusText))},o.onerror=function(){r(Error("Network Error"))},o.send()})}},{},],6:[function(e,t,n){"use strict";var r=e("./base64"),o=e("./fetch");function a(e){return function(t){return"string"==typeof t&&e.test(t)}}function i(e,t){return"string"==typeof e?e+t:"function"==typeof e?e(t):t}function s(e,t,n,r){var o,a,i,s=(o=t,o instanceof ArrayBuffer)?u:c(t)?l:(a=t,a&&"function"==typeof a.then)?f:d(t)?p:(i=t,i&&"object"==typeof i)?h:m(t)?v:_(t)?g:y(t)?$:null;return s?s(e,t,n||{}):r?Promise.resolve(r):Promise.reject("Source not valid ("+t+")")}function u(e,t,n){return new Promise(function(n,r){e.decodeAudioData(t,function(e){n(e)},function(){r("Can't decode audio data ("+t.slice(0,30)+"...)")})})}s.fetch=o;var c=a(/\.(mp3|wav|ogg)(\?.*)?$/i);function l(e,t,n){var r=i(n.from,t);return s(e,s.fetch(r,"arraybuffer"),n)}function f(e,t,n){return t.then(function(t){return s(e,t,n)})}var d=Array.isArray;function p(e,t,n){return Promise.all(t.map(function(t){return s(e,t,n,t)}))}function h(e,t,n){var r={};return Promise.all(Object.keys(t).map(function(o){if(n.only&&-1===n.only.indexOf(o))return null;var a=t[o];return s(e,a,n,a).then(function(e){r[o]=e})})).then(function(){return r})}var m=a(/\.json(\?.*)?$/i);function v(e,t,n){var r=i(n.from,t);return s(e,s.fetch(r,"text").then(JSON.parse),n)}var _=a(/^data:audio/);function g(e,t,n){var o=t.indexOf(",");return s(e,r.decode(t.slice(o+1)).buffer,n)}var y=a(/\.js(\?.*)?$/i);function $(e,t,n){var r=i(n.from,t);return s(e,s.fetch(r,"text").then(b),n)}function b(e){var t=e.indexOf("MIDI.Soundfont.");if(t<0)throw Error("Invalid MIDI.js Soundfont format");t=e.indexOf("=",t)+2;var n=e.lastIndexOf(",");return JSON.parse(e.slice(t,n)+"}")}"object"==typeof t&&t.exports&&(t.exports=s),"undefined"!=typeof window&&(window.loadAudio=s)},{"./base64":4,"./fetch":5},],7:[function(e,t,n){(function(r){!function(e){if("object"==typeof n&&void 0!==t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o;(o="undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this).midimessage=e()}}(function(){return(function t(n,r,o){function a(s,u){if(!r[s]){if(!n[s]){var c="function"==typeof e&&e;if(!u&&c)return c(s,!0);if(i)return i(s,!0);var l=Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[s]={exports:{}};n[s][0].call(f.exports,function(e){var t;return a(n[s][1][e]||e)},f,f.exports,t,n,r,o)}return r[s].exports}for(var i="function"==typeof e&&e,s=0;s<o.length;s++)a(o[s]);return a})({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return new function e(t){if(this._event=t,this._data=t.data,this.receivedTime=t.receivedTime,this._data&&this._data.length<2){console.warn("Illegal MIDI message of length",this._data.length);return}switch(this._messageCode=240&t.data[0],this.channel=15&t.data[0],this._messageCode){case 128:this.messageType="noteoff",this.key=127&t.data[1],this.velocity=127&t.data[2];break;case 144:this.messageType="noteon",this.key=127&t.data[1],this.velocity=127&t.data[2];break;case 160:this.messageType="keypressure",this.key=127&t.data[1],this.pressure=127&t.data[2];break;case 176:this.messageType="controlchange",this.controllerNumber=127&t.data[1],this.controllerValue=127&t.data[2],120===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allsoundoff":121===this.controllerNumber?this.channelModeMessage="resetallcontrollers":122===this.controllerNumber?0===this.controllerValue?this.channelModeMessage="localcontroloff":this.channelModeMessage="localcontrolon":123===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="allnotesoff":124===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeoff":125===this.controllerNumber&&0===this.controllerValue?this.channelModeMessage="omnimodeon":126===this.controllerNumber?this.channelModeMessage="monomodeon":127===this.controllerNumber&&(this.channelModeMessage="polymodeon");break;case 192:this.messageType="programchange",this.program=t.data[1];break;case 208:this.messageType="channelpressure",this.pressure=127&t.data[1];break;case 224:this.messageType="pitchbendchange";var n=127&t.data[2],r=127&t.data[1];this.pitchBend=(n<<8)+r}}(e)},t.exports=n.default},{},]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{},],8:[function(e,t,n){var r,o;r=this,o=function(e){"use strict";function t(e,t){return Array(t+1).join(e)}function n(e){return"number"==typeof e}function r(e,t){return Math.pow(2,(e-69)/12)*(t||440)}function o(){return s}function a(e,t,n){if("string"!=typeof e)return null;var o=s.exec(e);if(!o||!t&&o[4])return null;var a={letter:o[1].toUpperCase(),acc:o[2].replace(/x/g,"##")};a.pc=a.letter+a.acc,a.step=(a.letter.charCodeAt(0)+3)%7,a.alt="b"===a.acc[0]?-a.acc.length:a.acc.length;var i=u[a.step]+a.alt;return a.chroma=i<0?12+i:i%12,o[3]&&(a.oct=+o[3],a.midi=i+12*(a.oct+1),a.freq=r(a.midi,n)),t&&(a.tonicOf=o[4]),a}function i(e){if((n(e)||"string"==typeof(t=e))&&e>=0&&e<128)return+e;var t,r,o=a(e);return o&&void 0!==(r=o.midi)?o.midi:null}var s=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/,u=[0,2,4,5,7,9,11];e.regex=o,e.parse=a,e.build=function e(r,o,a){var i,s;return null==r?null:r.step?e(r.step,r.alt,r.oct):r<0||r>6?null:"CDEFGAB".charAt(r)+(n(i=o)?i<0?t("b",-i):t("#",i):"")+(n(s=a)?""+s:"")},e.midi=i,e.freq=function e(t,n){var o=i(t);return null===o?null:r(o,n)},e.letter=function e(t){return(a(t)||{}).letter},e.acc=function e(t){return(a(t)||{}).acc},e.pc=function e(t){return(a(t)||{}).pc},e.step=function e(t){return(a(t)||{}).step},e.alt=function e(t){return(a(t)||{}).alt},e.chroma=function e(t){return(a(t)||{}).chroma},e.oct=function e(t){return(a(t)||{}).oct}},"object"==typeof n&&void 0!==t?o(n):"function"==typeof define&&define.amd?define(["exports"],o):o(r.NoteParser=r.NoteParser||{})},{},],9:[function(e,t,n){t.exports=function(e){return e.on=function(t,n){if(1===arguments.length&&"function"==typeof t)return e.on("event",t);var r,o,a="on"+t,i=e[a];return e[a]=i?(r=i,o=n,function(e,t,n,a){r(e,t,n,a),o(e,t,n,a)}):n,e},e}},{},],10:[function(e,t,n){"use strict";var r=e("./player"),o=e("./events"),a=e("./notes"),i=e("./scheduler"),s=e("./midi");function u(e,t,n){return s(i(a(o(r(e,t,n)))))}"object"==typeof t&&t.exports&&(t.exports=u),"undefined"!=typeof window&&(window.SamplePlayer=u)},{"./events":9,"./midi":11,"./notes":12,"./player":13,"./scheduler":14},],11:[function(e,t,n){var r=e("midimessage");t.exports=function(e){return e.listenToMidi=function(t,n){var o={},a=n||{},i=a.gain||function(e){return e/127};return t.onmidimessage=function(t){var n=t.messageType?t:r(t);if("noteon"===n.messageType&&0===n.velocity&&(n.messageType="noteoff"),!a.channel||n.channel===a.channel)switch(n.messageType){case"noteon":o[n.key]=e.play(n.key,0,{gain:i(n.velocity)});break;case"noteoff":o[n.key]&&(o[n.key].stop(),delete o[n.key])}},e},e}},{midimessage:7},],12:[function(e,t,n){"use strict";var r=e("note-parser"),o=function(e){var t;return null!==(t=e)&&t!==[]&&t>=0&&t<129?+e:r.midi(e)};t.exports=function(e){if(e.buffers){var t,n,r=e.opts.map,a="function"==typeof r?r:o,i=function(e){return e?a(e)||e:null};e.buffers=(t=e.buffers,n=i,Object.keys(t).reduce(function(e,r){return e[n(r)]=t[r],e},{}));var s=e.start;e.start=function(e,t,n){var r=i(e),o=r%1;return o&&(r=Math.floor(r),n=Object.assign(n||{},{cents:Math.floor(100*o)})),s(r,t,n)}}return e}},{"note-parser":15},],13:[function(e,t,n){"use strict";var r=e("adsr"),o={},a={gain:1,attack:.01,decay:.1,sustain:.9,release:.3,loop:!1,cents:0,loopStart:0,loopEnd:0};function i(e){return"number"==typeof e}var s=["attack","decay","sustain","release"];t.exports=function e(t,n,u){var c=!1,l=0,f={},d=t.createGain();d.gain.value=1;var p=Object.assign({},a,u),h={context:t,out:d,opts:p};return n instanceof AudioBuffer?h.buffer=n:h.buffers=n,h.start=function(e,n,a){if(h.buffer&&null!==e)return h.start(null,e,n);var u=e?h.buffers[e]:h.buffer;if(u){if(!c){console.warn("SamplePlayer not connected to any node.");return}}else{console.warn("Buffer "+e+" not found.");return}var m,v,_,g,y,$,b,T,x,w,A=a||o;n=Math.max(t.currentTime,n||0),h.emit("start",n,e,A);var S,k,M=(m=e,v=u,_=A,g=t.createGain(),g.gain.value=0,g.connect(d),g.env=(y=t,$=_,b=p,T=r(y),x=$.adsr||b.adsr,s.forEach(function(e,t){x?T[e]=x[t]:T[e]=$[e]||b[e]}),T.value.value=i($.gain)?$.gain:i(b.gain)?b.gain:1,T),g.env.connect(g.gain),g.source=t.createBufferSource(),g.source.buffer=v,g.source.connect(g),g.source.loop=_.loop||p.loop,g.source.playbackRate.value=(w=_.cents||p.cents,w?Math.pow(2,w/1200):1),g.source.loopStart=_.loopStart||p.loopStart,g.source.loopEnd=_.loopEnd||p.loopEnd,g.stop=function(e){var n=e||t.currentTime;h.emit("stop",n,m);var r=g.env.stop(n);g.source.stop(r)},g);return M.id=(S=e,k=M,k.id=l++,f[k.id]=k,k.source.onended=function(){var e=t.currentTime;k.source.disconnect(),k.env.disconnect(),k.disconnect(),h.emit("ended",e,k.id,k)},k.id),M.env.start(n),M.source.start(n),h.emit("started",n,M.id,M),A.duration&&M.stop(n+A.duration),M},h.play=function(e,t,n){return h.start(e,t,n)},h.stop=function(e,t){var n;return(t=t||Object.keys(f)).map(function(t){return(n=f[t])?(n.stop(e),n.id):null})},h.connect=function(e){return c=!0,d.connect(e),h},h.emit=function(e,t,n,r){h.onevent&&h.onevent(e,t,n,r);var o=h["on"+e];o&&o(t,n,r)},h}},{adsr:3},],14:[function(e,t,n){"use strict";var r=Array.isArray,o={};t.exports=function(e){return e.schedule=function(t,n){var a,i,s,u,c=e.context.currentTime,l=t<c?c:t;return e.emit("schedule",l,n),n.map(function(t){var n;return t?(r(t)?(a=t[0],i=t[1]):(a=t.time,i=t),(n=i)&&"object"==typeof n?(s=i.name||i.key||i.note||i.midi||null,u=i):(s=i,u=o),e.start(s,l+(a||0),u)):null})},e}},{},],15:[function(e,t,n){"use strict";var r=/^([a-gA-G])(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)\s*$/;function o(){return r}var a=[0,2,4,5,7,9,11];function i(e,t,n){if("string"!=typeof e)return null;var o=r.exec(e);if(!o||!t&&o[4])return null;var i={letter:o[1].toUpperCase(),acc:o[2].replace(/x/g,"##")};return i.pc=i.letter+i.acc,i.step=(i.letter.charCodeAt(0)+3)%7,i.alt="b"===i.acc[0]?-i.acc.length:i.acc.length,i.chroma=a[i.step]+i.alt,o[3]&&(i.oct=+o[3],i.midi=i.chroma+12*(i.oct+1),i.freq=s(i.midi,n)),t&&(i.tonicOf=o[4]),i}function s(e,t){return Math.pow(2,(e-69)/12)*(t||440)}var u={parse:i,regex:o,midiToFreq:s};["letter","acc","pc","step","alt","chroma","oct","midi","freq",].forEach(function(e){u[e]=function(t){var n=i(t);return n&&void 0!==n[e]?n[e]:null}}),t.exports=u},{},]},{},[1]);