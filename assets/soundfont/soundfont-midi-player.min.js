class SoundfontMidiPlayer{constructor(){this.timeList=[],this.noteList=[],this.loadNote=function(t){this.noteList=t},this.instrument=[],this.setAudioContext=function(t){this.audioContext=t},this.lastTime=0,this.lastNote=0,this.play=function(i,s,e){if(e){let n=this.getNote(s);if(null!=n){let o=this.audioContext.currentTime;if(o>=0){let h=(n.duration+n.start-s)*1e3;if(h>0&&t.lastTime!=n.time){t.lastTime=n.time,t.lastNote=n.note;this.instrument[i].play(n.note,o,{duration:h})}}}}},this.inList=function(t){for(let i in this.timeList)if(this.timeList[i]==t)return!0;return!1},this.removeTimeFromList=function(t){this.timeList=this.timeList.splice(t,1)},this.addList=function(t){this.timeList.push(t)},this.lastIndex=0,this.lastTimeSecond=0,this.getStartIndex=function(t){return t>this.lastTimeSecond?this.lastIndex:0},this.getNote=function(t){let i=this.getStartIndex();for(let s=i;s<this.noteList.length;s++)if(this.noteList[s].start<=t&&this.noteList[s].end>=t)return this.lastIndex=s,this.noteList[s];return null},this.loadInstrument=function(i,s){Soundfont.instrument(this.audioContext,s,{nameToUrl:function(t,s,e){return i+(s="FluidR3_GM"===s?s:"Planetbiru")+"/"+t+"-"+(e="ogg"===e?e:"mp3")+".js"}}).then(function(i){t.instrument[s]=i})};let t=this}}